{"version":3,"file":"content.js","sources":["../src/content.tsx"],"sourcesContent":["import { createRoot } from 'react-dom/client';\nimport './index.css';\n\nasync function scrapePublicationDetails(url: string) {\n  const response = await fetch(url);\n  const text = await response.text();\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(text, 'text/html');\n  \n  return {\n    citations: Array.from(doc.querySelectorAll('.gsc_a_tr')).map(citation => ({\n      authors: citation.querySelector('.gsc_a_at')?.textContent || '',\n      isSelfCitation: false, // Will be determined by comparing authors\n    }))\n  };\n}\n\nfunction scrapeProfileData() {\n  const data = {\n    name: document.querySelector('#gsc_prf_in')?.textContent || '',\n    affiliation: document.querySelector('.gsc_prf_il')?.textContent || '',\n    citations: Array.from(document.querySelectorAll('#gsc_rsb_st tr')).map(row => ({\n      metric: row.querySelector('td:first-child')?.textContent || '',\n      all: row.querySelector('td:nth-child(2)')?.textContent || '',\n      since2018: row.querySelector('td:last-child')?.textContent || ''\n    })),\n    publications: Array.from(document.querySelectorAll('#gsc_a_b .gsc_a_tr')).map(pub => ({\n      title: pub.querySelector('.gsc_a_t a')?.textContent || '',\n      authors: pub.querySelector('.gsc_a_t .gsc_a_at')?.textContent || '',\n      venue: pub.querySelector('.gsc_a_t .gsc_a_v')?.textContent || '',\n      year: pub.querySelector('.gsc_a_y')?.textContent || '',\n      citations: parseInt(pub.querySelector('.gsc_a_c')?.textContent || '0'),\n      url: pub.querySelector('.gsc_a_t a')?.getAttribute('href') || ''\n    })),\n    coauthors: Array.from(document.querySelectorAll('#gsc_rsb_co .gsc_rsb_a_desc')).map(coauthor => ({\n      name: coauthor.querySelector('.gsc_rsb_a_desc a')?.textContent || '',\n      imageUrl: coauthor.querySelector('img')?.src || '',\n      profileUrl: coauthor.querySelector('a')?.href || ''\n    }))\n  };\n\n  return data;\n}\n\nfunction calculateAdvancedMetrics(data: any) {\n  const totalPubs = data.publications.length;\n  const pubsByYear: Record<string, number> = {};\n  let selfCitations = 0;\n  let totalCitations = 0;\n  \n  // Calculate publications per year\n  data.publications.forEach((pub: any) => {\n    if (pub.year) {\n      pubsByYear[pub.year] = (pubsByYear[pub.year] || 0) + 1;\n    }\n    totalCitations += pub.citations;\n  });\n\n  // Calculate average publications per year\n  const years = Object.keys(pubsByYear);\n  const avgPubsPerYear = totalPubs / years.length;\n\n  // Estimate self-citation rate (simplified version)\n  const authorName = data.name.split(' ')[1]; // Last name\n  data.publications.forEach((pub: any) => {\n    if (pub.authors.includes(authorName)) {\n      selfCitations += Math.round(pub.citations * 0.2); // Estimated self-citation rate\n    }\n  });\n\n  const scrRate = (selfCitations / totalCitations) * 100;\n  const sIndex = (data.publications.filter((p: any) => p.citations > 0).length / totalPubs) * 100;\n  \n  return {\n    totalPublications: totalPubs,\n    publicationsPerYear: avgPubsPerYear.toFixed(1),\n    selfCitationRate: scrRate.toFixed(1) + '%',\n    sIndex: sIndex.toFixed(1) + '%',\n    hpIndex: Math.round(data.citations[0].all * 0.8), // Simplified pure h-index\n    rcr: ((totalCitations / totalPubs) / 10).toFixed(2) // Simplified RCR\n  };\n}\n\nfunction injectMetricsUI(metrics: any) {\n  const container = document.createElement('div');\n  container.className = 'scholar-metrics-container';\n  container.innerHTML = `\n    <style>\n      .scholar-metrics-container {\n        margin: 20px 0;\n        padding: 16px;\n        background: rgba(255, 255, 255, 0.8);\n        backdrop-filter: blur(12px);\n        border-radius: 16px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.05);\n        border: 1px solid rgba(0,0,0,0.1);\n      }\n      .metrics-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n        gap: 12px;\n        margin-top: 12px;\n      }\n      .metric-card {\n        background: rgba(255, 255, 255, 0.9);\n        padding: 12px;\n        border-radius: 12px;\n        border: 1px solid rgba(0,0,0,0.05);\n      }\n      .metric-title {\n        font-size: 0.75rem;\n        color: #64748b;\n        margin-bottom: 4px;\n      }\n      .metric-value {\n        font-size: 1.25rem;\n        font-weight: 600;\n        color: #1e40af;\n      }\n      .metrics-header {\n        font-size: 1rem;\n        font-weight: 600;\n        color: #1e293b;\n        margin-bottom: 12px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n      }\n    </style>\n    <div class=\"metrics-grid\">\n      ${Object.entries(metrics).map(([key, value]) => `\n        <div class=\"metric-card\">\n          <div class=\"metric-title\">${key.replace(/([A-Z])/g, ' $1').trim()}</div>\n          <div class=\"metric-value\">${value}</div>\n        </div>\n      `).join('')}\n    </div>\n  `;\n\n  const profileHeader = document.querySelector('#gsc_prf_i');\n  if (profileHeader) {\n    profileHeader.appendChild(container);\n  }\n}\n\n// Listen for profile page loads\nif (window.location.pathname.includes('/citations')) {\n  const profileData = scrapeProfileData();\n  const advancedMetrics = calculateAdvancedMetrics(profileData);\n  \n  chrome.runtime.sendMessage({ \n    type: 'PROFILE_DATA',\n    data: { ...profileData, ...advancedMetrics }\n  }, (response) => {\n    chrome.runtime.sendMessage({ type: 'GET_METRICS' }, (metrics) => {\n      if (metrics) {\n        injectMetricsUI(metrics);\n      }\n    });\n  });\n\n  // Fetch co-author metrics\n  profileData.coauthors.forEach(async (coauthor: any) => {\n    if (coauthor.profileUrl) {\n      try {\n        const response = await fetch(coauthor.profileUrl);\n        const text = await response.text();\n        const parser = new DOMParser();\n        const doc = parser.parseFromString(text, 'text/html');\n        \n        const citations = doc.querySelector('#gsc_rsb_st tr:first-child td:nth-child(2)')?.textContent || '0';\n        const hIndex = doc.querySelector('#gsc_rsb_st tr:nth-child(2) td:nth-child(2)')?.textContent || '0';\n        \n        coauthor.citations = parseInt(citations);\n        coauthor.hIndex = parseInt(hIndex);\n        \n        // Update UI with co-author metrics\n        const coauthorElement = document.querySelector(`a[href=\"${coauthor.profileUrl}\"]`)?.parentElement;\n        if (coauthorElement) {\n          const metricsDiv = document.createElement('div');\n          metricsDiv.className = 'coauthor-metrics';\n          metricsDiv.innerHTML = `\n            <span class=\"text-sm text-gray-600\">\n              ${citations} citations â€¢ h-index: ${hIndex}\n            </span>\n          `;\n          coauthorElement.appendChild(metricsDiv);\n        }\n      } catch (error) {\n        console.error('Error fetching co-author metrics:', error);\n      }\n    }\n  });\n}"],"names":["scrapeProfileData","_a","_b","row","_c","pub","_d","_e","_f","coauthor","calculateAdvancedMetrics","data","totalPubs","pubsByYear","selfCitations","totalCitations","years","avgPubsPerYear","authorName","scrRate","sIndex","p","injectMetricsUI","metrics","container","key","value","profileHeader","profileData","advancedMetrics","response","text","doc","citations","hIndex","coauthorElement","metricsDiv","error"],"mappings":"mCAiBA,SAASA,GAAoB,SAwBpB,MAvBM,CACX,OAAMC,EAAA,SAAS,cAAc,aAAa,IAApC,YAAAA,EAAuC,cAAe,GAC5D,cAAaC,EAAA,SAAS,cAAc,aAAa,IAApC,YAAAA,EAAuC,cAAe,GACnE,UAAW,MAAM,KAAK,SAAS,iBAAiB,gBAAgB,CAAC,EAAE,IAAYC,GAAA,WAAA,OAC7E,SAAQF,EAAAE,EAAI,cAAc,gBAAgB,IAAlC,YAAAF,EAAqC,cAAe,GAC5D,MAAKC,EAAAC,EAAI,cAAc,iBAAiB,IAAnC,YAAAD,EAAsC,cAAe,GAC1D,YAAWE,EAAAD,EAAI,cAAc,eAAe,IAAjC,YAAAC,EAAoC,cAAe,EAAA,EAC9D,EACF,aAAc,MAAM,KAAK,SAAS,iBAAiB,oBAAoB,CAAC,EAAE,IAAYC,GAAA,iBAAA,OACpF,QAAOJ,EAAAI,EAAI,cAAc,YAAY,IAA9B,YAAAJ,EAAiC,cAAe,GACvD,UAASC,EAAAG,EAAI,cAAc,oBAAoB,IAAtC,YAAAH,EAAyC,cAAe,GACjE,QAAOE,EAAAC,EAAI,cAAc,mBAAmB,IAArC,YAAAD,EAAwC,cAAe,GAC9D,OAAME,EAAAD,EAAI,cAAc,UAAU,IAA5B,YAAAC,EAA+B,cAAe,GACpD,UAAW,WAASC,EAAAF,EAAI,cAAc,UAAU,IAA5B,YAAAE,EAA+B,cAAe,GAAG,EACrE,MAAKC,EAAAH,EAAI,cAAc,YAAY,IAA9B,YAAAG,EAAiC,aAAa,UAAW,EAAA,EAC9D,EACF,UAAW,MAAM,KAAK,SAAS,iBAAiB,6BAA6B,CAAC,EAAE,IAAiBC,GAAA,WAAA,OAC/F,OAAMR,EAAAQ,EAAS,cAAc,mBAAmB,IAA1C,YAAAR,EAA6C,cAAe,GAClE,WAAUC,EAAAO,EAAS,cAAc,KAAK,IAA5B,YAAAP,EAA+B,MAAO,GAChD,aAAYE,EAAAK,EAAS,cAAc,GAAG,IAA1B,YAAAL,EAA6B,OAAQ,EAAA,EACjD,CAAA,CAIN,CAEA,SAASM,EAAyBC,EAAW,CACrC,MAAAC,EAAYD,EAAK,aAAa,OAC9BE,EAAqC,CAAA,EAC3C,IAAIC,EAAgB,EAChBC,EAAiB,EAGhBJ,EAAA,aAAa,QAASN,GAAa,CAClCA,EAAI,OACNQ,EAAWR,EAAI,IAAI,GAAKQ,EAAWR,EAAI,IAAI,GAAK,GAAK,GAEvDU,GAAkBV,EAAI,SAAA,CACvB,EAGK,MAAAW,EAAQ,OAAO,KAAKH,CAAU,EAC9BI,EAAiBL,EAAYI,EAAM,OAGnCE,EAAaP,EAAK,KAAK,MAAM,GAAG,EAAE,CAAC,EACpCA,EAAA,aAAa,QAASN,GAAa,CAClCA,EAAI,QAAQ,SAASa,CAAU,IACjCJ,GAAiB,KAAK,MAAMT,EAAI,UAAY,EAAG,EACjD,CACD,EAEK,MAAAc,EAAWL,EAAgBC,EAAkB,IAC7CK,EAAUT,EAAK,aAAa,OAAQU,GAAWA,EAAE,UAAY,CAAC,EAAE,OAAST,EAAa,IAErF,MAAA,CACL,kBAAmBA,EACnB,oBAAqBK,EAAe,QAAQ,CAAC,EAC7C,iBAAkBE,EAAQ,QAAQ,CAAC,EAAI,IACvC,OAAQC,EAAO,QAAQ,CAAC,EAAI,IAC5B,QAAS,KAAK,MAAMT,EAAK,UAAU,CAAC,EAAE,IAAM,EAAG,EAC/C,KAAOI,EAAiBH,EAAa,IAAI,QAAQ,CAAC,CAAA,CAEtD,CAEA,SAASU,EAAgBC,EAAc,CAC/B,MAAAC,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,4BACtBA,EAAU,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA4ChB,OAAO,QAAQD,CAAO,EAAE,IAAI,CAAC,CAACE,EAAKC,CAAK,IAAM;AAAA;AAAA,sCAEhBD,EAAI,QAAQ,WAAY,KAAK,EAAE,MAAM;AAAA,sCACrCC,CAAK;AAAA;AAAA,OAEpC,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA,IAIT,MAAAC,EAAgB,SAAS,cAAc,YAAY,EACrDA,GACFA,EAAc,YAAYH,CAAS,CAEvC,CAGA,GAAI,OAAO,SAAS,SAAS,SAAS,YAAY,EAAG,CACnD,MAAMI,EAAc5B,IACd6B,EAAkBnB,EAAyBkB,CAAW,EAE5D,OAAO,QAAQ,YAAY,CACzB,KAAM,eACN,KAAM,CAAE,GAAGA,EAAa,GAAGC,CAAgB,CAC7C,EAAIC,GAAa,CACf,OAAO,QAAQ,YAAY,CAAE,KAAM,aAAc,EAAIP,GAAY,CAC3DA,GACFD,EAAgBC,CAAO,CACzB,CACD,CAAA,CACF,EAGWK,EAAA,UAAU,QAAQ,MAAOnB,GAAkB,WACrD,GAAIA,EAAS,WACP,GAAA,CAEI,MAAAsB,EAAO,MADI,MAAM,MAAMtB,EAAS,UAAU,GACpB,OAEtBuB,EADS,IAAI,YACA,gBAAgBD,EAAM,WAAW,EAE9CE,IAAYhC,EAAA+B,EAAI,cAAc,4CAA4C,IAA9D,YAAA/B,EAAiE,cAAe,IAC5FiC,IAAShC,EAAA8B,EAAI,cAAc,6CAA6C,IAA/D,YAAA9B,EAAkE,cAAe,IAEvFO,EAAA,UAAY,SAASwB,CAAS,EAC9BxB,EAAA,OAAS,SAASyB,CAAM,EAGjC,MAAMC,GAAkB/B,EAAA,SAAS,cAAc,WAAWK,EAAS,UAAU,IAAI,IAAzD,YAAAL,EAA4D,cACpF,GAAI+B,EAAiB,CACb,MAAAC,EAAa,SAAS,cAAc,KAAK,EAC/CA,EAAW,UAAY,mBACvBA,EAAW,UAAY;AAAA;AAAA,gBAEjBH,CAAS,yBAAyBC,CAAM;AAAA;AAAA,YAG9CC,EAAgB,YAAYC,CAAU,CACxC,QACOC,EAAO,CACN,QAAA,MAAM,oCAAqCA,CAAK,CAC1D,CACF,CACD,CACH"}