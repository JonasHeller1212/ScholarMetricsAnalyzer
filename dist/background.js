let n=null;chrome.runtime.onMessage.addListener((t,r,o)=>{if(t.type==="PROFILE_DATA"){n=t.data,console.log("Received profile data:",n);const a=h(n);chrome.storage.local.set({scholarMetrics:a}),o({success:!0})}if(t.type==="GET_METRICS")return chrome.storage.local.get(["scholarMetrics"],a=>{o(a.scholarMetrics||null)}),!0});function h(t){const r=t.publications.map(e=>parseInt(e.citations)||0).sort((e,i)=>i-e);let o=0;for(let e=0;e<r.length&&r[e]>=e+1;e++)o=e+1;let a=0,s=0;for(let e=0;e<r.length&&(s+=r[e],s>=Math.pow(e+1,2));e++)a=e+1;const l=r.filter(e=>e>=10).length,f=r.reduce((e,i)=>e+i,0),c={};return t.publications.forEach(e=>{const i=e.year;i&&!isNaN(i)&&(c[i]=(c[i]||0)+(parseInt(e.citations)||0))}),{name:t.name,affiliation:t.affiliation,hIndex:o,gIndex:a,i10Index:l,totalCitations:f,citationsPerYear:c}}
//# sourceMappingURL=background.js.map
